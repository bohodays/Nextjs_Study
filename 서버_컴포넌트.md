### 1. React Server Component

---

- React 18v 부터 새롭게 추가된, 새로운 유형의 컴포넌트
- 서버측에서만 실행되는 컴포넌트 (브라우저에서 실행 X)
- app router에서는 기본적으로 모든 컴포넌트가 서버 컴포넌트로 되어있음

<br>

### 2. Server Component의 등장배경

---

- 사전 렌더링 과정에서 Hydration을 위한 JS Bundle을 후속으로 전달하는데, 해당 JS Bundle은 모든 컴포넌트들이 포함되어 있음
  - React hooks나 이벤트 핸들러 등이 없는 컴포넌트, 즉 상호작용이 없는 컴포넌트들도 포함되어 있음
  - 이러한 컴포넌트들은 Hydration될 필요 없음.
  - 불필요하게 많은 컴포넌트들이 JS Bundle에 포함되어 있어 파일 크기가 커지고, Hydration 시간이 커짐

<br>

### 3. 분류

---

- 서버 컴포넌트
  - 상호작용이 없는 컴포넌트
  - 서버 측에서 사전 렌더링을 진행할 때, 한번만 실행되는 컴포넌트
- 클라이언트 컴포넌트
  - 상호작용이 있는 컴포넌트
  - 서버 측에서 사전 렌더링을 진행할 때 한번, Hydration을 진행할 때 한번, 총 2번 실행되는 컴포넌트
  - 일반적인 React 컴포넌트
  - 최상단에 `"use client"`를 붙여야 한다.
- 페이지의 대부분을 `서버 컴포넌트`로 구성할 것을 권장하며, `클라이언트 컴포넌트`는 꼭 필요한 경우에만 사용할 것

<br>

### 4. 주의사항

---

- `서버 컴포넌트에는 브라우저에서 실행될 코드가 포함되면 안된다.`
  - React hooks나 onClick 등의 코드가 있으면 안된다.
  - **브라우저에서 실행되는 기능을 담고 있는 라이브러리도 안된다.**
- `클라이언트 컴포넌트는 클라이언트에서만 실행되지 않는다.`
  - 클라이언트 컴포넌트는 서버 측에서 사전 렌더링을 진행할 때 한번, Hydration을 진행할 때 한번, 총 2번 실행된다.
- `클라이언트 컴포넌트에서 서버 컴포넌트를 import 할 수 없다.`
  - 서버 컴포넌트의 코드는 오직 서버에서만 실행되기 때문에 브라우저에서 실행될 수 없다.
  - NextJs는 클라이언트 컴포넌트에서 서버 컴포넌트를 import하려고 하면 에러를 발생시키지 않고, **자동으로 서버 컴포넌트를 클라이언트 컴포넌트로 변경한다.**
    - **서버 컴포넌트를 children으로 전달하면 클라이언트 컴포넌트로 변경되지 않음**
- `서버 컴포넌트에서 클라이언트 컴포넌트에게 직렬화되지 않는 Props는 전달 불가하다.`
  - 자바스크립트의 함수는 직렬화가 불가능하다. 따라서 함수는 서버 컴포넌트에서 클라이언트 컴포넌트로 전달될 수 없다.
  - 사전 렌더링 과정을 엄밀히 표현하면
    - 페이지를 구성하는 모든 컴포넌트들 -> 서버 컴포넌트들만 따로 실행 -> 완성된 HTML 페이지
      - 서버 컴포넌트들만 따로 실행되는 과정에서 **RSC Payload**라는 JSON과 비슷한 문자열이 생성됨.
        - RSC Payload
          - React Server Component의 순수한 데이터(결과물)
          - React Server Component를 직렬화한 결과
          - 서버 컴포넌트의 렌더링 결과, 연결된 클라이언트 컴포넌트의 위치, 클라이언트 컴포넌트에게 전달하는 Props 값 등의 모든 데이터가 포함됨
